Данный скрипт является свободным программным обеспечением, распространяющимся по лицензии MIT.
Копия лицензии: https://opensource.org/licenses/MIT

Copyright (c) 2024 Otto
Автор: Otto
Версия: 02.08.24
GitHub страница:  https://github.com/Otto17/DAVrun
GitFlic страница: https://gitflic.ru/project/otto/davrun

г. Омск 2024



Скрипт настройке WebDAV с SSL на Linux сервере + базовая защита от перебора паролей.

ПОДРАЗУМЕВАЕТСЯ, ЧТО У ВАС УЖЕ УСТАНОВЛЕН ЧИСТЫЙ ДИСТРИБУТИВ Debian или Ubuntu Sever (либо другой совместимый по командам в скрипте дистрибутив).

Порядок установки через SSH:
1) Копируем скрипт "install_WebDAV.sh" в домашнюю директорию пользователя любым способом (я использую программу WinSCP);
2) Открываем "nano install_WebDAV.sh" и редактируем поля в пункте # -/-/-/- НАСТРОЙКИ -/-/-/- # (логин [до 32 символов], пароль [до 64 символов], данные сертификата. макс. кол-во подключений к серверу и если нужно добавляем ip адреса для исключения в Fail2Ban), затем сохраняем Ctrl+O и Enter и выходим Ctrl+X;
P.S. Нельзя использовать в логине или пароле спецсимволы !#$%&()*+./:;=<>?@[\]^`{|}~'\, это может привести к ошибке в скрипте, непредсказуемому поведению Apache, а так же к возможным уязвимостям. Удобно настраиваемый генератор паролей "https://www.roboform.com/ru/password-generator"

3) Делаем исполняемым "chmod +x install_WebDAV.sh";
4) запускаем "sudo ./install_WebDAV.sh" и ждём;
5) Готово, можно удалить скрипт "rm install_WebDAV.sh".

Скрипт проверил на чисто установленных системах: Ubuntu 22.04, Ubuntu Server 24.04 и Debian 12.5.

P.S. Для Дебиана нужно сначала установить sudo (если не было выбрано окружение рабочего стола Debian перед установкой системы), добавить пользователя в группу sudo и перезагрузиться:
1) su
2) apt install sudo
3) sudo usermod -aG sudo [тут имя пользователя]
4) systemctl reboot
5) Проверяем например командой "sudo apt update"
6) Узнать IP адрес можно командой "ip a"
7) Далее по инструкции скрипта...


Так же самостоятельно не забываем о безопасности, измените настройки SSH под свои нужны (к примеру ограничьте доступ к SSH только с определённых IP через ufw и НЕ ВЫСТАВЛЯЙТЕ НАРУЖУ SSH, он вам вряд ли понадобится, а безопасность возрастёт).

Если по какой то причине на Debian ругается, что "bash: a2enmod: команда не найдена", выполните скрипт от root: su - root

Посмотреть заблокированные IP командой:
"sudo fail2ban-client status sshd" или "sudo fail2ban-client status webdav" (смотря в какой секции бан)

Исключить заблокированные IP командой:
"sudo fail2ban-client set sshd unbanip 192.168.1.27" или "sudo fail2ban-client set webdav unbanip 192.168.0.17" (смотря в какой секции бан)